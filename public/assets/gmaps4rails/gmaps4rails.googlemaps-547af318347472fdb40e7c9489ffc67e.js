((function(){var a={}.hasOwnProperty,b=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};this.Gmaps4RailsGoogle=function(a){function c(){c.__super__.constructor.apply(this,arguments),this.map_options={disableDefaultUI:!1,disableDoubleClickZoom:!1,type:"ROADMAP"},this.markers_conf={clusterer_gridSize:50,clusterer_maxZoom:5,custom_cluster_pictures:null,custom_infowindow_class:null},this.mergeWithDefault("map_options"),this.mergeWithDefault("markers_conf"),this.kml_options={clickable:!0,preserveViewport:!1,suppressInfoWindows:!1},this.polygons_conf={strokeColor:"#FFAA00",strokeOpacity:.8,strokeWeight:2,fillColor:"#000000",fillOpacity:.35,clickable:!1},this.circles_conf={fillColor:"#00AAFF",fillOpacity:.35,strokeColor:"#FFAA00",strokeOpacity:.8,strokeWeight:2,clickable:!1,zIndex:null},this.direction_conf={panel_id:null,display_panel:!1,origin:null,destination:null,waypoints:[],optimizeWaypoints:!1,unitSystem:"METRIC",avoidHighways:!1,avoidTolls:!1,region:null,travelMode:"DRIVING"}}return b(c,a),c.prototype.createPoint=function(a,b){return new google.maps.Point(a,b)},c.prototype.createLatLng=function(a,b){return new google.maps.LatLng(a,b)},c.prototype.createLatLngBounds=function(){return new google.maps.LatLngBounds},c.prototype.createMap=function(){var a,b;return a={maxZoom:this.map_options.maxZoom,minZoom:this.map_options.minZoom,zoom:this.map_options.zoom,center:this.createLatLng(this.map_options.center_latitude,this.map_options.center_longitude),mapTypeId:google.maps.MapTypeId[this.map_options.type],mapTypeControl:this.map_options.mapTypeControl,disableDefaultUI:this.map_options.disableDefaultUI,disableDoubleClickZoom:this.map_options.disableDoubleClickZoom,draggable:this.map_options.draggable},b=this.mergeObjectWithDefault(this.map_options.raw,a),new google.maps.Map(document.getElementById(this.map_options.id),b)},c.prototype.createMarkerImage=function(a,b,c,d,e){return new google.maps.MarkerImage(a,b,c,d,e)},c.prototype.createSize=function(a,b){return new google.maps.Size(a,b)},c.prototype.createMarker=function(a){var b,c,d,e,f,g,h;return e=this.createLatLng(a.Lat,a.Lng),a.marker_picture===""&&a.rich_marker===null?(b={position:e,map:this.serviceObject,title:a.marker_title,draggable:a.marker_draggable,zIndex:a.zindex},f=this.mergeObjectWithDefault(this.markers_conf.raw,b),new google.maps.Marker(f)):a.rich_marker!==null?new RichMarker({position:e,map:this.serviceObject,draggable:a.marker_draggable,content:a.rich_marker,flat:a.marker_anchor===null?!1:a.marker_anchor[1],anchor:a.marker_anchor===null?0:a.marker_anchor[0],zIndex:a.zindex}):(c=this.createImageAnchorPosition(a.marker_anchor),g=this.createImageAnchorPosition(a.shadow_anchor),d=this.createOrRetrieveImage(a.marker_picture,a.marker_width,a.marker_height,c),h=this.createOrRetrieveImage(a.shadow_picture,a.shadow_width,a.shadow_height,g),b={position:e,map:this.serviceObject,icon:d,title:a.marker_title,draggable:a.marker_draggable,shadow:h,zIndex:a.zindex},f=this.mergeObjectWithDefault(this.markers_conf.raw,b),new google.maps.Marker(f))},c.prototype.includeMarkerImage=function(a,b){var c,d,e,f;for(c=e=0,f=a.length;e<f;c=++e){d=a[c];if(d.url===b)return c}return!1},c.prototype.createOrRetrieveImage=function(a,b,c,d){var e,f;if(a===""||a===null)return null;f=this.includeMarkerImage(this.markerImages,a);switch(f){case!1:return e=this.createMarkerImage(a,this.createSize(b,c),null,d,null),this.markerImages.push(e),e;default:if(typeof f=="number")return this.markerImages[f];return!1}},c.prototype.clearMarkers=function(){var a,b,c,d,e;d=this.markers,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(this.clearMarker(a));return e},c.prototype.showMarkers=function(){var a,b,c,d,e;d=this.markers,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(this.showMarker(a));return e},c.prototype.hideMarkers=function(){var a,b,c,d,e;d=this.markers,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(this.hideMarker(a));return e},c.prototype.clearMarker=function(a){return a.serviceObject.setMap(null)},c.prototype.showMarker=function(a){return a.serviceObject.setVisible(!0)},c.prototype.hideMarker=function(a){return a.serviceObject.setVisible(!1)},c.prototype.extendBoundsWithMarkers=function(){var a,b,c,d,e;d=this.markers,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(this.boundsObject.extend(a.serviceObject.position));return e},c.prototype.createClusterer=function(a){return new MarkerClusterer(this.serviceObject,a,{maxZoom:this.markers_conf.clusterer_maxZoom,gridSize:this.markers_conf.clusterer_gridSize,styles:this.customClusterer()})},c.prototype.clearClusterer=function(){return this.markerClusterer.clearMarkers()},c.prototype.clusterize=function(){var a,b,c,d,e;if(this.markers_conf.do_clustering===!0){this.markerClusterer!==null&&this.clearClusterer(),b=new Array,e=this.markers;for(c=0,d=e.length;c<d;c++)a=e[c],b.push(a.serviceObject);return this.markerClusterer=this.createClusterer(b)}},c.prototype.createInfoWindow=function(a){var b,c;if(typeof this.jsTemplate=="function"||a.description!=null)return typeof this.jsTemplate=="function"&&(a.description=this.jsTemplate(a)),this.markers_conf.custom_infowindow_class!==null?(b=document.createElement("div"),b.setAttribute("class",this.markers_conf.custom_infowindow_class),b.innerHTML=a.description,a.infowindow=new InfoBox(this.infobox(b)),c=this,google.maps.event.addListener(a.serviceObject,"click",this.openInfoWindow(c,a.infowindow,a.serviceObject))):(a.infowindow=new google.maps.InfoWindow({content:a.description}),c=this,google.maps.event.addListener(a.serviceObject,"click",this.openInfoWindow(c,a.infowindow,a.serviceObject)))},c.prototype.openInfoWindow=function(a,b,c){return function(){return a.visibleInfoWindow!==null&&a.visibleInfoWindow.close(),b.open(a.serviceObject,c),a.visibleInfoWindow=b}},c.prototype.createKmlLayer=function(a){var b;return b=a.options||{},b=this.mergeObjectWithDefault(b,this.kml_options),a=new google.maps.KmlLayer(a.url,b),a.setMap(this.serviceObject),a},c.prototype.create_polyline=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;h=[];for(m=0,o=a.length;m<o;m++){d=a[m];if(d.coded_array!=null){c=new google.maps.geometry.encoding.decodePath(d.coded_array);for(n=0,p=c.length;n<p;n++)g=c[n],h.push(g)}else d===a[0]&&(i=d.strokeColor||this.polylines_conf.strokeColor,j=d.strokeOpacity||this.polylines_conf.strokeOpacity,k=d.strokeWeight||this.polylines_conf.strokeWeight,b=d.clickable||this.polylines_conf.clickable,l=d.zIndex||this.polylines_conf.zIndex),d.lat!=null&&d.lng!=null&&(e=this.createLatLng(d.lat,d.lng),h.push(e))}return f=new google.maps.Polyline({path:h,strokeColor:i,strokeOpacity:j,strokeWeight:k,clickable:b,zIndex:l}),a.serviceObject=f,f.setMap(this.serviceObject)},c.prototype.updateBoundsWithPolylines=function(){var a,b,c,d,e,f,g;f=this.polylines,g=[];for(d=0,e=f.length;d<e;d++)b=f[d],c=b.serviceObject.latLngs.getArray()[0].getArray(),g.push(function(){var b,d,e;e=[];for(b=0,d=c.length;b<d;b++)a=c[b],e.push(this.boundsObject.extend(a));return e}.call(this));return g},c.prototype.create_kml=function(){var a,b,c,d,e;d=this.kml,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(a.serviceObject=this.createKmlLayer(a));return e},c.prototype.fitBounds=function(){if(!this.boundsObject.isEmpty())return this.serviceObject.fitBounds(this.boundsObject)},c.prototype.centerMapOnUser=function(){return this.serviceObject.setCenter(this.userLocation)},c.prototype.updateBoundsWithPolygons=function(){var a,b,c,d,e,f,g;f=this.polygons,g=[];for(d=0,e=f.length;d<e;d++)b=f[d],c=b.serviceObject.latLngs.getArray()[0].getArray(),g.push(function(){var b,d,e;e=[];for(b=0,d=c.length;b<d;b++)a=c[b],e.push(this.boundsObject.extend(a));return e}.call(this));return g},c.prototype.updateBoundsWithCircles=function(){var a,b,c,d,e;d=this.circles,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],this.boundsObject.extend(a.serviceObject.getBounds().getNorthEast()),e.push(this.boundsObject.extend(a.serviceObject.getBounds().getSouthWest()));return e},c.prototype.extendMapBounds=function(){var a,b,c,d,e;d=this.map_options.bounds,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(this.boundsObject.extend(this.createLatLng(a.lat,a.lng)));return e},c.prototype.adaptMapToBounds=function(){var a;return this.map_options.auto_zoom?this.fitBounds():(a=this.boundsObject.getCenter(),this.map_options.center_latitude=a.lat(),this.map_options.center_longitude=a.lng(),this.serviceObject.setCenter(a))},c}(Gmaps4Rails)})).call(this);